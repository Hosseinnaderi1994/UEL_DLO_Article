*Heading
UEL_DLO_article
**
************************************************************************
** UNIT SYSTEM
************************************************************************
**
** UNITS: Length - meters, Time - sec, Angle - radians,
** Temperature - Kelvin, Force - Newtons,
** Stress - Newton/meter^2 = Pa, Mass - kilograms,
** Density - kg/meter^3, Conductivity - Watt/m-K,
** Specific Heat - J/kg-K, Energy - Joules,
** Chemical potential - Joules/mole,
** Fluid content - moles/volume
**
*Node
      1, 0.00300000003, 0.00270000007
      2,           0., 0.00270000007
      3,           0.,           0.
      4, 0.00300000003,           0.
      5, 0.00300000003, 0.00300000003
      6,           0., 0.00300000003
      7, 0.00270000007, 0.00270000007
      8, 0.00240000011, 0.00270000007
      9, 0.00209999993, 0.00270000007
     10, 0.00179999997, 0.00270000007
     11, 0.00150000001, 0.00270000007
     12, 0.00120000006, 0.00270000007
     13, 0.000899999985, 0.00270000007
     14, 0.000600000028, 0.00270000007
     15, 0.000300000014, 0.00270000007
     16,           0., 0.00240000011
     17,           0., 0.00209999993
     18,           0., 0.00179999997
     19,           0., 0.00150000001
     20,           0., 0.00120000006
     21,           0., 0.000899999985
     22,           0., 0.000600000028
     23,           0., 0.000300000014
     24, 0.000300000014,           0.
     25, 0.000600000028,           0.
     26, 0.000899999985,           0.
     27, 0.00120000006,           0.
     28, 0.00150000001,           0.
     29, 0.00179999997,           0.
     30, 0.00209999993,           0.
     31, 0.00240000011,           0.
     32, 0.00270000007,           0.
     33, 0.00300000003, 0.000300000014
     34, 0.00300000003, 0.000600000028
     35, 0.00300000003, 0.000899999985
     36, 0.00300000003, 0.00120000006
     37, 0.00300000003, 0.00150000001
     38, 0.00300000003, 0.00179999997
     39, 0.00300000003, 0.00209999993
     40, 0.00300000003, 0.00240000011
     41, 0.00300000003, 0.00285000005
     42, 0.00270000007, 0.00300000003
     43, 0.00240000011, 0.00300000003
     44, 0.00209999993, 0.00300000003
     45, 0.00179999997, 0.00300000003
     46, 0.00150000001, 0.00300000003
     47, 0.00120000006, 0.00300000003
     48, 0.000899999985, 0.00300000003
     49, 0.000600000028, 0.00300000003
     50, 0.000300000014, 0.00300000003
     51,           0., 0.00285000005
     52, 0.00270000007, 0.00240000011
     53, 0.00240000011, 0.00240000011
     54, 0.00209999993, 0.00240000011
     55, 0.00179999997, 0.00240000011
     56, 0.00150000001, 0.00240000011
     57, 0.00120000006, 0.00240000011
     58, 0.000899999985, 0.00240000011
     59, 0.000600000028, 0.00240000011
     60, 0.000300000014, 0.00240000011
     61, 0.00270000007, 0.00209999993
     62, 0.00240000011, 0.00209999993
     63, 0.00209999993, 0.00209999993
     64, 0.00179999997, 0.00209999993
     65, 0.00150000001, 0.00209999993
     66, 0.00120000006, 0.00209999993
     67, 0.000899999985, 0.00209999993
     68, 0.000600000028, 0.00209999993
     69, 0.000300000014, 0.00209999993
     70, 0.00270000007, 0.00179999997
     71, 0.00240000011, 0.00179999997
     72, 0.00209999993, 0.00179999997
     73, 0.00179999997, 0.00179999997
     74, 0.00150000001, 0.00179999997
     75, 0.00120000006, 0.00179999997
     76, 0.000899999985, 0.00179999997
     77, 0.000600000028, 0.00179999997
     78, 0.000300000014, 0.00179999997
     79, 0.00270000007, 0.00150000001
     80, 0.00240000011, 0.00150000001
     81, 0.00209999993, 0.00150000001
     82, 0.00179999997, 0.00150000001
     83, 0.00150000001, 0.00150000001
     84, 0.00120000006, 0.00150000001
     85, 0.000899999985, 0.00150000001
     86, 0.000600000028, 0.00150000001
     87, 0.000300000014, 0.00150000001
     88, 0.00270000007, 0.00120000006
     89, 0.00240000011, 0.00120000006
     90, 0.00209999993, 0.00120000006
     91, 0.00179999997, 0.00120000006
     92, 0.00150000001, 0.00120000006
     93, 0.00120000006, 0.00120000006
     94, 0.000899999985, 0.00120000006
     95, 0.000600000028, 0.00120000006
     96, 0.000300000014, 0.00120000006
     97, 0.00270000007, 0.000899999985
     98, 0.00240000011, 0.000899999985
     99, 0.00209999993, 0.000899999985
    100, 0.00179999997, 0.000899999985
    101, 0.00150000001, 0.000899999985
    102, 0.00120000006, 0.000899999985
    103, 0.000899999985, 0.000899999985
    104, 0.000600000028, 0.000899999985
    105, 0.000300000014, 0.000899999985
    106, 0.00270000007, 0.000600000028
    107, 0.00240000011, 0.000600000028
    108, 0.00209999993, 0.000600000028
    109, 0.00179999997, 0.000600000028
    110, 0.00150000001, 0.000600000028
    111, 0.00120000006, 0.000600000028
    112, 0.000899999985, 0.000600000028
    113, 0.000600000028, 0.000600000028
    114, 0.000300000014, 0.000600000028
    115, 0.00270000007, 0.000300000014
    116, 0.00240000011, 0.000300000014
    117, 0.00209999993, 0.000300000014
    118, 0.00179999997, 0.000300000014
    119, 0.00150000001, 0.000300000014
    120, 0.00120000006, 0.000300000014
    121, 0.000899999985, 0.000300000014
    122, 0.000600000028, 0.000300000014
    123, 0.000300000014, 0.000300000014
    124, 0.000300000014, 0.00285000005
    125, 0.000600000028, 0.00285000005
    126, 0.000899999985, 0.00285000005
    127, 0.00120000006, 0.00285000005
    128, 0.00150000001, 0.00285000005
    129, 0.00179999997, 0.00285000005
    130, 0.00209999993, 0.00285000005
    131, 0.00240000011, 0.00285000005
    132, 0.00270000007, 0.00285000005
**
*User Element,Type=U1,Nodes=4,Coordinates=2,Properties=7,Iproperties=2,Variables=2,Unsymm
1,2,11
*Element, type=U1
 1,   1,   7,  52,  40
 2,   7,   8,  53,  52
 3,   8,   9,  54,  53
 4,   9,  10,  55,  54
 5,  10,  11,  56,  55
 6,  11,  12,  57,  56
 7,  12,  13,  58,  57
 8,  13,  14,  59,  58
 9,  14,  15,  60,  59
10,  15,   2,  16,  60
11,  40,  52,  61,  39
12,  52,  53,  62,  61
13,  53,  54,  63,  62
14,  54,  55,  64,  63
15,  55,  56,  65,  64
16,  56,  57,  66,  65
17,  57,  58,  67,  66
18,  58,  59,  68,  67
19,  59,  60,  69,  68
20,  60,  16,  17,  69
21,  39,  61,  70,  38
22,  61,  62,  71,  70
23,  62,  63,  72,  71
24,  63,  64,  73,  72
25,  64,  65,  74,  73
26,  65,  66,  75,  74
27,  66,  67,  76,  75
28,  67,  68,  77,  76
29,  68,  69,  78,  77
30,  69,  17,  18,  78
31,  38,  70,  79,  37
32,  70,  71,  80,  79
33,  71,  72,  81,  80
34,  72,  73,  82,  81
35,  73,  74,  83,  82
36,  74,  75,  84,  83
37,  75,  76,  85,  84
38,  76,  77,  86,  85
39,  77,  78,  87,  86
40,  78,  18,  19,  87
41,  37,  79,  88,  36
42,  79,  80,  89,  88
43,  80,  81,  90,  89
44,  81,  82,  91,  90
45,  82,  83,  92,  91
46,  83,  84,  93,  92
47,  84,  85,  94,  93
48,  85,  86,  95,  94
49,  86,  87,  96,  95
50,  87,  19,  20,  96
51,  36,  88,  97,  35
52,  88,  89,  98,  97
53,  89,  90,  99,  98
54,  90,  91, 100,  99
55,  91,  92, 101, 100
56,  92,  93, 102, 101
57,  93,  94, 103, 102
58,  94,  95, 104, 103
59,  95,  96, 105, 104
60,  96,  20,  21, 105
61,  35,  97, 106,  34
62,  97,  98, 107, 106
63,  98,  99, 108, 107
64,  99, 100, 109, 108
65, 100, 101, 110, 109
66, 101, 102, 111, 110
67, 102, 103, 112, 111
68, 103, 104, 113, 112
69, 104, 105, 114, 113
70, 105,  21,  22, 114
71,  34, 106, 115,  33
72, 106, 107, 116, 115
73, 107, 108, 117, 116
74, 108, 109, 118, 117
75, 109, 110, 119, 118
76, 110, 111, 120, 119
77, 111, 112, 121, 120
78, 112, 113, 122, 121
79, 113, 114, 123, 122
80, 114,  22,  23, 123
81,  33, 115,  32,   4
82, 115, 116,  31,  32
83, 116, 117,  30,  31
84, 117, 118,  29,  30
85, 118, 119,  28,  29
86, 119, 120,  27,  28
87, 120, 121,  26,  27
88, 121, 122,  25,  26
89, 122, 123,  24,  25
90, 123,  23,   3,  24
 91,   2,  15, 124,  51
 92,  15,  14, 125, 124
 93,  14,  13, 126, 125
 94,  13,  12, 127, 126
 95,  12,  11, 128, 127
 96,  11,  10, 129, 128
 97,  10,   9, 130, 129
 98,   9,   8, 131, 130
 99,   8,   7, 132, 131
100,   7,   1,  41, 132
101,  51, 124,  50,   6
102, 124, 125,  49,  50
103, 125, 126,  48,  49
104, 126, 127,  47,  48
105, 127, 128,  46,  47
106, 128, 129,  45,  46
107, 129, 130,  44,  45
108, 130, 131,  43,  44
109, 131, 132,  42,  43
110, 132,  41,   5,  42
**
** Create the ‘‘dummy’’ mesh used for visualization.
** These ‘‘dummy’’ elements have the same connectivity, and use the same nodes,
** however their element number (first column) is offset by a constant, in this case 1000.
**
** IMPORTANT: This constant offset must also be set in the UVARM subroutine in
** the ElemOffset=1000 variable
*Element, type=CPE4R
1001,   1,   7,  52,  40
1002,   7,   8,  53,  52
1003,   8,   9,  54,  53
1004,   9,  10,  55,  54
1005,  10,  11,  56,  55
1006,  11,  12,  57,  56
1007,  12,  13,  58,  57
1008,  13,  14,  59,  58
1009,  14,  15,  60,  59
1010,  15,   2,  16,  60
1011,  40,  52,  61,  39
1012,  52,  53,  62,  61
1013,  53,  54,  63,  62
1014,  54,  55,  64,  63
1015,  55,  56,  65,  64
1016,  56,  57,  66,  65
1017,  57,  58,  67,  66
1018,  58,  59,  68,  67
1019,  59,  60,  69,  68
1020,  60,  16,  17,  69
1021,  39,  61,  70,  38
1022,  61,  62,  71,  70
1023,  62,  63,  72,  71
1024,  63,  64,  73,  72
1025,  64,  65,  74,  73
1026,  65,  66,  75,  74
1027,  66,  67,  76,  75
1028,  67,  68,  77,  76
1029,  68,  69,  78,  77
1030,  69,  17,  18,  78
1031,  38,  70,  79,  37
1032,  70,  71,  80,  79
1033,  71,  72,  81,  80
1034,  72,  73,  82,  81
1035,  73,  74,  83,  82
1036,  74,  75,  84,  83
1037,  75,  76,  85,  84
1038,  76,  77,  86,  85
1039,  77,  78,  87,  86
1040,  78,  18,  19,  87
1041,  37,  79,  88,  36
1042,  79,  80,  89,  88
1043,  80,  81,  90,  89
1044,  81,  82,  91,  90
1045,  82,  83,  92,  91
1046,  83,  84,  93,  92
1047,  84,  85,  94,  93
1048,  85,  86,  95,  94
1049,  86,  87,  96,  95
1050,  87,  19,  20,  96
1051,  36,  88,  97,  35
1052,  88,  89,  98,  97
1053,  89,  90,  99,  98
1054,  90,  91, 100,  99
1055,  91,  92, 101, 100
1056,  92,  93, 102, 101
1057,  93,  94, 103, 102
1058,  94,  95, 104, 103
1059,  95,  96, 105, 104
1060,  96,  20,  21, 105
1061,  35,  97, 106,  34
1062,  97,  98, 107, 106
1063,  98,  99, 108, 107
1064,  99, 100, 109, 108
1065, 100, 101, 110, 109
1066, 101, 102, 111, 110
1067, 102, 103, 112, 111
1068, 103, 104, 113, 112
1069, 104, 105, 114, 113
1070, 105,  21,  22, 114
1071,  34, 106, 115,  33
1072, 106, 107, 116, 115
1073, 107, 108, 117, 116
1074, 108, 109, 118, 117
1075, 109, 110, 119, 118
1076, 110, 111, 120, 119
1077, 111, 112, 121, 120
1078, 112, 113, 122, 121
1079, 113, 114, 123, 122
1080, 114,  22,  23, 123
1081,  33, 115,  32,   4
1082, 115, 116,  31,  32
1083, 116, 117,  30,  31
1084, 117, 118,  29,  30
1085, 118, 119,  28,  29
1086, 119, 120,  27,  28
1087, 120, 121,  26,  27
1088, 121, 122,  25,  26
1089, 122, 123,  24,  25
1090, 123,  23,   3,  24
 1091,   2,  15, 124,  51
1092,  15,  14, 125, 124
 1093,  14,  13, 126, 125
1094,  13,  12, 127, 126
 1095,  12,  11, 128, 127
 1096,  11,  10, 129, 128
 1097,  10,   9, 130, 129
 1098,   9,   8, 131, 130
 1099,   8,   7, 132, 131
1100,   7,   1,  41, 132
1101,  51, 124,  50,   6
1102, 124, 125,  49,  50
1103, 125, 126,  48,  49
1104, 126, 127,  47,  48
1105, 127, 128,  46,  47
1106, 128, 129,  45,  46
1107, 129, 130,  44,  45
1108, 130, 131,  43,  44
1109, 131, 132,  42,  43
1110, 132,  41,   5,  42
**
*Nset, nset=all, generate
   1,  132,    1
*Elset, elset=all, generate
   1,  110,    1
*Nset, nset=left
  2,  3,  6, 16, 17, 18, 19, 20, 21, 22, 23, 51
*Elset, elset=left
  10,  20,  30,  40,  50,  60,  70,  80,  90,  91, 101
*Nset, nset=bottom
  3,  4, 24, 25, 26, 27, 28, 29, 30, 31, 32
*Elset, elset=bottom, generate
 81,  90,   1
*Nset, nset=right
  1,  4,  5, 33, 34, 35, 36, 37, 38, 39, 40, 41
*Elset, elset=right
   1,  11,  21,  31,  41,  51,  61,  71,  81, 100, 110
*Nset, nset=top
  5,  6, 42, 43, 44, 45, 46, 47, 48, 49, 50
*Elset, elset=top, generate
 101,  110,    1
**
*Elset, elset=elDummy, generate 
1001,1110,1 
**
**
** Make an element, of type CPE4T, which is not connected to anything.
** This element makes available the coupled thermal-displacement step,
** and has no effect on the real problem.
** We refer to this element as the ‘‘extra’’ element.
*Node
999996, 0.0, 0.0
999997, .00001, 0.0
999998, .00001, .00001
999999, 0.0, .00001
*Nset, nset=extraElement
999996,999997,999998,999999
*Element, Type=CPE4T
999999,999996,999997,999998,999999
*Elset,elset=extraElement
999999
**
************************************************************************
** PARAMETERS
************************************************************************
**
*Parameter
**
** initial oxygen concentration
CR0 = 2.80
**
** temperature (Kelvin)
theta = 100.0 + 273.0
**
** Shear modulus (Pa)
Gshr = 5.0e7
**
** Hourglass stiffness (Pa)
Ghour = 0.005*Gshr
**
** total aging time (seconds)
tf = 3600.0*60.0
** total ramp time (seconds)
tRamp = 3600.0*2.0
**
**
************************************************************************
** MATERIAL DEFINITION
************************************************************************
**
** Material properties for the UEL Elements
*uel property,elset=all
** G      Kbulk   gama  chi   Vmol      Rgas 
 0.5e9,  1.0e6, -0.01, 0.1, 0.14675, 8.3145
** theta nlSdv ngSdv
  <theta>, 2,4
**
** Material properties for the ‘‘dummy’’ elements
** Notice the very small elastic modulus.
*Solid section, elset=ElDummy, material=DummyMaterial
**Hourglass stiffness
 <Ghour>
**
*Material, name=DummyMaterial
*Elastic
1.e-20
*User output variables
4
**
** Material properties for the ‘‘extra’’ element.
** These are irrelevant and need not be modified.
*Solid section, elset=extraElement, material=extraMaterial
*Material, name=extraMaterial
*Elastic
1.e-20
*Conductivity
1.0
*Density
1.0
*Specific heat
1.0
**
**
************************************************************************
** INITIAL CONDITIONS
************************************************************************
** Define the initial oxygen concentration
*Initial conditions, type=temperature
all, 0.0
**
** Define an arbitrary initial condition for the ‘‘extra’’ element.
*Initial conditions, type=temperature
extraElement, 0.0
**
************************************************************************
** AMPLITUDE DEFINITION
************************************************************************
**
** Define the oxygen concentration amplitude we will apply to the body
*Amplitude, name=ocProfile
0.0,0.0,<tRamp>,<CR0>,<tf>,<CR0>
** 
*Amplitude, name=dispProfile
 0.0,0.0,<tRamp>,3.0e-05,<tf>,3.0e-05
** 
**
************************************************************************
** STEP DEFINITION
************************************************************************
** 
*Step, name=Step-1, nlgeom=yes, inc=100000
*Coupled temperature-displacement, deltmx=100.0
10.0,<tf>,1.e-6,100.0
*CONTROLS, PARAMETERS=FIELD, FIELD=displacement
0.005,0.01,0.01,0.01,2.0e-2,1.e-3,1.e-3,1.e-5
1.0,1.e-5,1.e-6
*Controls, Parameters=Line Search
10,1.0,0.0001,0.25,0.10
*Controls, Parameters=Time Incrementation
,,,,,,,10,,,,,,
**
** BOUNDARY CONDITIONS
** 
*Boundary
left, XSYMM
bottom, YSYMM
right, XSYMM
**
*Boundary, amplitude=dispProfile
top, 2, 2, 1
**
*Boundary, amplitude=ocProfile
left,11,11,1.0
right,11,11,1.0
**
** Restrict ALL degrees of freedom of the ‘‘extra’’ element
*Boundary
extraElement,encastre
extraElement,11,11,0.0
**
*Output, field, number interval=100, time marks=no
*node output, nset=all
u,nt
*Node output, nset=extraElement
u
*Element output, elset=ElDummy
uvarm,le
**
*End Step
